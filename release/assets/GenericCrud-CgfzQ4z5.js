import{r as c,o as e}from"./index-CNB927hB.js";import{a as j}from"./axiosUtil-D-9LEqQl.js";import{s as S,F as u,I as b,B as E,C as M}from"./index-Bf_qaFUW.js";import{S as I,P as k,M as C,F as O}from"./Table-DzCBn_30.js";const F={labelCol:{span:8},wrapperCol:{span:16}},v={wrapperCol:{offset:8,span:16}},w=r=>{const x=j(),[i,h]=S.useMessage(),[l]=u.useForm();c.useEffect(()=>{f()},[]);const f=async()=>{try{console.log("loading...")}catch(n){console.error("Error[48593]:",n),console.error("Error[48593]:",n)}},y=async n=>{try{console.log("creating..."),i.open({type:"loading",content:"Saving..",duration:1.5});let t={};r.fields.forEach(m=>{t[m.name]=n[m.name]});const a=await x.post(r.endpoint,t);console.log("Response:",a),i.open({type:"success",content:"Success"})}catch(t){console.error("Error[22894]:",t);const a=t;i.open({type:"error",content:JSON.stringify(a.response.data)}),console.error("Error[22894]:",a)}};return e.jsxs(u,{...F,form:l,name:"generic-crud",onFinish:y,style:{maxWidth:600},children:[e.jsx("h2",{children:"Create"}),r.fields.map(n=>e.jsx(u.Item,{name:n.name,label:n.label,rules:n.rules,children:e.jsx(b,{})})),e.jsx(u.Item,{...v,children:e.jsx(I,{children:e.jsx(k,{title:"Save",description:"Are you sure to save?",onConfirm:()=>{l.submit()},onCancel:()=>{},okText:"Yes",cancelText:"No",children:e.jsx(E,{type:"primary",children:"Save"})})})}),h]})},L=r=>{const x=j(),[i,h]=S.useMessage(),[l]=u.useForm(),[f,y]=c.useState(),[n,t]=c.useState(!0);c.useEffect(()=>{t(!0),a()},[r.id]);const a=async()=>{try{console.log("loading...");const s=await x.get(`${r.endpoint}${r.id}/`);y(s.data),t(!1),l.setFieldsValue(s.data),console.log("init->",s.data)}catch(s){console.error("Error[74874]:",s),console.error("Error[74874]:",s)}},m=async s=>{try{console.log("updating..."),i.open({type:"loading",content:"Saving..",duration:1.5});let d={};r.fields.forEach(o=>{d[o.name]=s[o.name]});const p=await x.patch(`${r.endpoint}${f.id}/`,d);console.log("Response:",p),i.open({type:"success",content:"Success"})}catch(d){console.error("Error[38421]:",d);const p=d;i.open({type:"error",content:JSON.stringify(p.response.data)}),console.error("Error[38421]:",p)}};return n?e.jsx("p",{children:"Loading..."}):e.jsxs(u,{...F,form:l,name:"generic-edit",onFinish:m,style:{maxWidth:600},children:[e.jsx("h2",{children:"Edit2"}),r.fields.map(s=>e.jsx(u.Item,{name:s.name,label:s.label,rules:s.rules,children:e.jsx(b,{})})),e.jsx(u.Item,{...v,children:e.jsx(I,{children:e.jsx(k,{title:"Save",description:"Are you sure to save?",onConfirm:()=>{l.submit()},onCancel:()=>{},okText:"Yes",cancelText:"No",children:e.jsx(E,{type:"primary",children:"Save"})})})}),h]})},V=r=>{const x=j(),[i,h]=c.useState([]),[l,f]=c.useState(!0),[y,n]=c.useState(!1),[t,a]=c.useState(!1),[m,s]=c.useState(0);c.useEffect(()=>{f(!0),d()},[]);const d=async()=>{try{console.log("loading...");const o=await x.get(r.endpoint);h(o.data),f(!1)}catch(o){console.error("Error[64239]:",o),console.error("Error[64239]:",o)}},p=r.fields.map(o=>o.type==="boolean"?{title:o.label,dataIndex:o.name,key:o.name,render:g=>e.jsx(M,{checked:g,disabled:!0})}:{title:o.label,dataIndex:o.name,key:o.name});return p.push({title:"Actions",key:"actions",render:(o,g)=>e.jsx(E,{type:"primary",onClick:A=>{s(g.id),n(!0)},children:"Edit"})}),l?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{className:"GenericCrud",children:[e.jsx(E,{type:"primary",onClick:()=>a(!0),children:"Create"}),e.jsx(C,{title:"Create",open:t,onOk:()=>a(!1),onCancel:()=>a(!1),children:e.jsx(w,{fields:r.fields,endpoint:r.endpoint})}),e.jsx(O,{columns:p,dataSource:i}),e.jsx(C,{title:"Edit1",open:y,onOk:()=>n(!1),onCancel:()=>n(!1),children:e.jsx(L,{fields:r.fields,endpoint:r.endpoint,id:m})})]})};export{V as G};
